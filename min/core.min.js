/**
 * Simple JavaScript PDF Viewer
 * 
 * @version rolling-release
 * @license MIT
 * @author BrunoRNS
 * @see https://github.com/BrunoRNS/SimplePDFviewer
 * @see https://github.com/mozilla/pdf.js
 * @see https://www.jsdelivr.com/?docs=gh
 */
!function(e){"use strict";const r="3.11.174",t=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${r}/pdf.min.js`,n=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${r}/pdf.worker.min.js`;let o=!1;const i=[],a={};const l={available:function(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}(),setItem:function(e,r){this.available?localStorage.setItem(e,r):a[e]=r},getItem:function(e){return this.available?localStorage.getItem(e):a[e]||null},removeItem:function(e){this.available?localStorage.removeItem(e):delete a[e]}};function s(e){const r={"zoom-in":{svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>',fallback:"+"},"zoom-out":{svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="8" y1="11" x2="14" y2="11"></line></svg>',fallback:"−"},fullscreen:{svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>',fallback:"⛶"},hamburger:{svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',fallback:"☰"}},t=r[e]||r.hamburger;return`<span class="icon-svg">${t.svg}</span><span class="icon-fallback" role="img">${t.fallback}</span>`}const c={primary:"#3498db",primaryHover:"#2980b9",primaryActive:"#1f618d",sidebarPrimary:"#2c3e50",sidebarHover:"#3d566e",sidebarBorder:"#34495e",containerBg:"#f0f2f5",disabled:"#bdc3c7",lightBorder:"#ddd"},d=-18,p=-36,u=8,f=-8;function m(e){const[r,t,n]=function(e){let r=e.replace("#","");return 3===r.length&&(r=r.split("").map(e=>e+e).join("")),[parseInt(r.substring(0,2),16),parseInt(r.substring(2,4),16),parseInt(r.substring(4,6),16)]}(e),o=r/255,i=t/255,a=n/255,l=Math.max(o,i,a),s=Math.min(o,i,a);let c=0,d=0;const p=(l+s)/2;if(l!==s){const e=l-s;switch(d=p>.5?e/(2-l-s):e/(l+s),l){case o:c=((i-a)/e+(i<a?6:0))/6;break;case i:c=((a-o)/e+2)/6;break;case a:c=((o-i)/e+4)/6}}return{h:Math.round(360*c),s:Math.round(100*d),l:Math.round(100*p)}}function h(e,r,t){let n,o,i;if(e/=360,t/=100,0===(r/=100))n=o=i=t;else{const a=(e,r,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+6*(r-e)*t:t<.5?r:t<2/3?e+(r-e)*(2/3-t)*6:e),l=t<.5?t*(1+r):t+r-t*r,s=2*t-l;n=a(s,l,e+1/3),o=a(s,l,e),i=a(s,l,e-1/3)}return function(e,r,t){return"#"+[e,r,t].map(e=>{const r=e.toString(16);return 1===r.length?"0"+r:r}).join("")}(Math.round(255*n),Math.round(255*o),Math.round(255*i))}const v=(e=null)=>{const r=document.getElementById("pdf-viewer-styles"),t=e||c,n=r||document.createElement("style");n.id="pdf-viewer-styles",n.textContent=`\n            .pdf-viewer-container { display: flex; height: 100%; width: 100%; font-family: system-ui, -apple-system, sans-serif; background: ${t.containerBg}; overflow: hidden; position: relative; }\n            .pdf-viewer-sidebar { position: absolute; top: 0; left: -100%; width: 280px; height: 100%; background: ${t.sidebarPrimary}; color: #fff; transition: all 0.3s ease; z-index: 1001; overflow-y: auto; box-shadow: 2px 0 10px rgba(0,0,0,0.2); }\n            .pdf-viewer-sidebar.open { left: 0; }\n            .pdf-viewer-sidebar.collapsed { width: 60px; padding: 0; }\n            .pdf-viewer-sidebar.collapsed > div { display: none; }\n            .pdf-viewer-sidebar.collapsed .pdf-viewer-chapter-item { padding: 8px 0; text-align: center; }\n            .pdf-viewer-main { flex: 1; display: flex; flex-direction: column; min-width: 0; }\n            .pdf-viewer-controls { display: flex; align-items: center; justify-content: center; gap: 15px; padding: 10px; background: #fff; border-bottom: 1px solid ${t.lightBorder}; z-index: 10; }\n            .pdf-viewer-canvas-container { flex: 1; overflow: auto; padding: 5px; background: #525659; scroll-behavior: smooth; width: 100%; display: block; box-sizing: border-box; }\n            .pdf-viewer-canvas { width: 100%; height: auto; box-shadow: 0 0 15px rgba(0,0,0,0.3); background: #fff; }\n            .pdf-viewer-loading-overlay { position: absolute; top:0; left:0; right:0; bottom:0; background: rgba(255,255,255,0.7); display: flex; align-items: center; justify-content: center; z-index: 20; }\n            .pdf-viewer-footer { padding: 10px; background: #f0f0f0; border-top: 1px solid ${t.lightBorder}; text-align: center; font-size: 12px; color: #666; }\n            .pdf-viewer-chapter-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid ${t.sidebarBorder}; transition: background 0.2s; }\n            .pdf-viewer-chapter-item:hover { background: ${t.sidebarHover}; }\n            .pdf-viewer-chapter-item.active { background: ${t.primary}; border-left: 4px solid #fff; }\n            .pdf-viewer-btn { padding: 10px 16px; min-height: 44px; min-width: 44px; border: none; border-radius: 4px; cursor: pointer; background: ${t.primary}; color: white; font-weight: 500; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }\n            .pdf-viewer-btn:hover { background: ${t.primaryHover}; }\n            .pdf-viewer-btn:active { background: ${t.primaryActive}; }\n            .pdf-viewer-btn:disabled { background: ${t.disabled}; cursor: not-allowed; }\n            .zoom-controls { display: flex; gap: 5px; align-items: center; }\n            .zoom-controls .zoom-input { padding: 8px 12px; width: 60px; border: 1px solid ${t.lightBorder}; border-radius: 4px; font-size: 14px; text-align: center; font-weight: 500; }\n            .zoom-controls .zoom-input:focus { outline: none; border-color: ${t.primary}; box-shadow: 0 0 3px ${t.primary}; }\n            .icon-svg { display: inline-flex; width: 20px; height: 20px; color: inherit; align-items: center; justify-content: center; }\n            .icon-svg svg { width: 100%; height: 100%; }\n            .icon-fallback { display: none; font-size: 16px; line-height: 1; font-weight: bold; }\n            .pdf-viewer-main.fullscreen { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 10000; display: flex; flex-direction: column; background: ${t.sidebarPrimary}; }\n            .pdf-viewer-main.fullscreen .pdf-viewer-canvas-container { background: ${t.sidebarPrimary}; padding: 3px; box-sizing: border-box; }\n            .pdf-viewer-main.fullscreen .pdf-viewer-controls { position: relative; background: ${t.sidebarPrimary}; border-bottom: 3px solid ${t.primary}; }\n            .pdf-viewer-main.fullscreen .pdf-viewer-footer { position: relative; background: ${t.sidebarPrimary}; border-top: 3px solid ${t.primary}; color: #ccc; }\n            .pdf-viewer-main.fullscreen .pdf-viewer-toggle-btn { display: none; }\n            @media (min-width: 768px) {\n                .pdf-viewer-sidebar { position: relative; left: 0; }\n                .pdf-viewer-toggle-btn { display: none; }\n            }\n        `,r||document.head.appendChild(n)};function g(e){const r=function(e){if(!/^#[0-9A-Fa-f]{3}([0-9A-Fa-f]{3})?$/.test(e))return{valid:!1,error:"Invalid hex format. Use #RRGGBB or #RGB"};const r=m(e),t=r.l;let n=t;return t<15?n=25:t>85&&(n=75),{valid:!0,color:h(r.h,r.s,n),original:e,wasAdjusted:n!==t}}(e);if(!r.valid)return null;const t=r.color,n=m(t),o=Math.max(0,Math.min(100,n.l+d)),i=Math.max(0,Math.min(100,n.l+p)),a={...n};a.s=Math.max(0,a.s-30),a.l=Math.max(0,Math.min(100,a.l-25));const l=Math.max(0,Math.min(100,a.l+u)),s=Math.max(0,Math.min(100,a.l+f));return{primary:t,primaryHover:h(n.h,n.s,o),primaryActive:h(n.h,n.s,i),sidebarPrimary:h(a.h,a.s,a.l),sidebarHover:h(a.h,a.s,l),sidebarBorder:h(a.h,a.s,s),containerBg:"#f0f2f5",disabled:"#bdc3c7",lightBorder:"#ddd"}}e.PDFViewer={init:function(r,a,d={}){const p=(e=>e?e instanceof HTMLElement?{valid:!0,error:null}:{valid:!1,error:"Container must be an HTML element."}:{valid:!1,error:"Container element is required."})(r);if(!p.valid)return console.error(`PDFViewer: ${p.error}`),null;const u=(e=>{if(!e)return{valid:!1,error:"Course object is required."};if("string"!=typeof e.title)return{valid:!1,error:"Course must have a title (string)."};if(!Array.isArray(e.modules))return{valid:!1,error:"Course must have modules array."};if(0===e.modules.length)return{valid:!1,error:"Course must have at least one module."};for(let r=0;r<e.modules.length;r++){const t=e.modules[r];if("string"!=typeof t.title)return{valid:!1,error:`Module ${r} must have a title.`};if(!Array.isArray(t.chapters))return{valid:!1,error:`Module ${r} must have chapters array.`};if(0===t.chapters.length)return{valid:!1,error:`Module ${r} must have at least one chapter.`};for(let e=0;e<t.chapters.length;e++){const n=t.chapters[e];if("string"!=typeof n.title)return{valid:!1,error:`Module ${r}, Chapter ${e} must have a title.`};if("string"!=typeof n.pdf)return{valid:!1,error:`Module ${r}, Chapter ${e} must have a pdf URL.`}}}return{valid:!0,error:null}})(a);if(!u.valid)return console.error(`PDFViewer: ${u.error}`),null;let f=c;if(d.colorTheme){const e=g(d.colorTheme);e?f=e:console.warn(`\n                PDFViewer: Invalid colorTheme '${d.colorTheme}', using default theme\n                `)}v(f);const m={currentModule:0,currentChapter:0,currentPage:1,pdfDoc:null,renderTask:null,onError:d.onError||(()=>{}),listeners:{},themeColors:f,zoom:100,viewportX:0,viewportY:0,nextPage:()=>q(),prevPage:()=>F(),loadChapter:(e,r)=>L(e,r),setTheme:e=>function(e){const r=g(e);if(!r)return console.warn(`PDFViewer: Invalid color theme '${e}', theme not changed`),!1;return m.themeColors=r,v(r),!0}(e),setZoom:e=>S(e),destroy:()=>function(){document.removeEventListener("keydown",N);const e=r.querySelector(".pdf-viewer-canvas-container");e&&m.listeners.wheelHandler&&e.removeEventListener("wheel",m.listeners.wheelHandler);e&&e.removeEventListener("scroll",E,!0);m.resizeObserver&&m.resizeObserver.disconnect();m.renderTask&&m.renderTask.cancel()}()};r.innerHTML=`\n        <div class="pdf-viewer-container">\n            <aside class="pdf-viewer-sidebar" role="navigation" aria-label="PDF chapters">\n            </aside>\n            <main class="pdf-viewer-main">\n                <div class="pdf-viewer-controls" role="toolbar" aria-label="PDF viewer controls">\n                    <button class="pdf-viewer-btn pdf-viewer-toggle-btn" aria-label="Toggle sidebar" aria-expanded="false">\n                        ${s("hamburger")}\n                    </button>\n\n                    <button class="pdf-viewer-btn prev-btn" aria-label="Previous page">\n                        Previous\n                    </button>\n\n                    <button class="pdf-viewer-btn next-btn" aria-label="Next page">\n                        Next\n                    </button>\n\n                    <div class="zoom-controls">\n                        <button class="pdf-viewer-btn zoom-out-btn" aria-label="Zoom out" title="Zoom out">\n                            ${s("zoom-out")}\n                        </button>\n\n                        <input type="text" class="zoom-input" aria-label="Zoom level" placeholder="100%" value="100%">\n\n                        <button class="pdf-viewer-btn zoom-in-btn" aria-label="Zoom in" title="Zoom in">\n                            ${s("zoom-in")}\n                        </button>\n                    </div>\n\n                    <button class="pdf-viewer-btn fullscreen-btn" aria-label="Toggle fullscreen" title="Fullscreen (ESC to exit)">\n                        ${s("fullscreen")}\n                    </button>\n                </div>\n\n                <div class="pdf-viewer-canvas-container" tabindex="0">\n                    <canvas class="pdf-viewer-canvas" role="img" aria-label="PDF page content"></canvas>\n                </div>\n\n                <div class="pdf-viewer-footer" role="status" aria-live="polite" aria-atomic="true">\n                    <span class="pagination-info">\n                        Page <span class="page">1</span>/<span class="pages">-</span> |\n                        Chapter <span class="chapter">1</span>/<span class="chapters">-</span> |\n                        Module <span class="module">1</span>/<span class="modules">-</span>\n                    </span>\n                </div>\n            </main>\n\n            <div class="pdf-viewer-loading-overlay" style="display:none;" aria-live="polite">\n                Loading...\n            </div>\n        </div>\n        `;const h=r.querySelector(".pdf-viewer-sidebar"),b=r.querySelector(".pdf-viewer-canvas"),y=r.querySelector(".pdf-viewer-loading-overlay"),w=b.getContext("2d"),x=()=>{k(),z()},k=()=>{const e=r.querySelector(".prev-btn"),t=r.querySelector(".next-btn");if(!e||!t||!m.pdfDoc)return;const n=1===m.currentPage&&0===m.currentChapter&&0===m.currentModule,o=m.currentModule===a.modules.length-1&&m.currentChapter===a.modules[m.currentModule].chapters.length-1,i=m.currentPage===m.pdfDoc.numPages&&o;e.disabled=n,t.disabled=i},z=()=>{if(!m.pdfDoc)return;const e=m.currentModule+1,t=a.modules.length,n=m.currentChapter+1,o=a.modules[m.currentModule].chapters.length,i=r.querySelector(".pagination-info .page"),l=r.querySelector(".pagination-info .pages"),s=r.querySelector(".pagination-info .chapter"),c=r.querySelector(".pagination-info .chapters"),d=r.querySelector(".pagination-info .module"),p=r.querySelector(".pagination-info .modules");i&&(i.textContent=m.currentPage),l&&(l.textContent=m.pdfDoc?m.pdfDoc.numPages:"-"),s&&(s.textContent=n),c&&(c.textContent=o),d&&(d.textContent=e),p&&(p.textContent=t)};function M(){const e=r.querySelector(".zoom-input"),t=r.querySelector(".zoom-out-btn"),n=r.querySelector(".zoom-in-btn");e&&(e.value=m.zoom+"%"),t&&(t.disabled=m.zoom<=100),n&&(n.disabled=m.zoom>=200)}const $=e=>y.style.display=e?"flex":"none";let C=!1;const P=()=>{const e=A.style.scrollBehavior;A.style.scrollBehavior="auto",A.scrollTop=0,A.scrollLeft=0,A.scroll(0,0),A.scrollTo(0,0);let r=0;const t=()=>{if(r<15&C){const e=A.scrollTop,n=A.scrollLeft;0===e&&0===n||(A.scrollTop=0,A.scrollLeft=0,A.scroll(0,0),A.scrollTo(0,0)),r++,requestAnimationFrame(t)}};requestAnimationFrame(t),setTimeout(()=>{C=!1,A.style.scrollBehavior=e},600)},E=e=>{!C||0===A.scrollTop&&0===A.scrollLeft||(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),A.scrollTop=0,A.scrollLeft=0)};function S(e){if((e=Math.max(100,Math.min(200,Math.floor(e))))===m.zoom)return;const t=A,n=t.scrollWidth>0?t.scrollLeft/t.scrollWidth:0,o=t.scrollHeight>0?t.scrollTop/t.scrollHeight:0;m.zoom=e;const i=r.querySelector(".zoom-input");i&&(i.value=e+"%");const a=r.querySelector(".zoom-out-btn"),l=r.querySelector(".zoom-in-btn");a&&(a.disabled=e<=100),l&&(l.disabled=e>=200),M(),T(m.currentPage).then(()=>{setTimeout(()=>{t.scrollWidth>0&&(t.scrollLeft=n*t.scrollWidth),t.scrollHeight>0&&(t.scrollTop=o*t.scrollHeight)},0)})}function T(e){if(!(!m.pdfDoc||e<1||e>m.pdfDoc.numPages))return m.renderTask&&m.renderTask.cancel(),m.pdfDoc.getPage(e).then(e=>{try{const r=b.parentElement;let t=r.clientWidth;const n=window.getComputedStyle(r),o=parseFloat(n.paddingLeft)||0;t-=o+(parseFloat(n.paddingRight)||0);const i=window.devicePixelRatio||1;let a=t/e.getViewport({scale:1}).width*(m.zoom/100);m.zoom<=100&&(a=Math.max(1,a));const l=e.getViewport({scale:a*i});return b.width=l.width,b.height=l.height,b.style.width=l.width/i+"px",b.style.height=l.height/i+"px",m.renderTask=e.render({canvasContext:w,viewport:l}),m.renderTask.promise}catch(e){console.error("Error rendering page:",e),m.onError({type:"render",message:"Failed to render page",error:e})}}).catch(e=>{"RenderingCancelledException"!==e.name&&(console.error("Error rendering page:",e),m.onError({type:"render",message:"Failed to render page",error:e}))})}function L(r,l){const s=a.modules[r]?.chapters[l];if(!s){const e=`\n                    Invalid module or chapter index: module=${r}, chapter=${l}\n                `;return console.error(e),void m.onError({type:"load",message:e})}C=!0,$(!0),m.currentModule=r,m.currentChapter=l,m.zoom=100,function(r){if(void 0!==e.pdfjsLib)return r();if(i.push(r),o)return;o=!0;const a=document.createElement("script");a.src=t,a.onload=()=>{for(e.pdfjsLib.GlobalWorkerOptions.workerSrc=n;i.length>0;)i.shift()()},document.head.appendChild(a)}(()=>{try{pdfjsLib.getDocument(s.pdf).promise.then(e=>{m.pdfDoc=e,m.currentPage=1,T(1).then(()=>{P(),M()}),x(),h.innerHTML=`<div style="padding:20px; font-weight:bold; border-bottom:1px solid #444;">${a.title}</div>`,a.modules.forEach((e,r)=>{e.chapters.forEach((t,n)=>{const o=document.createElement("div");o.className="\n                        pdf-viewer-chapter-item "+(r===m.currentModule&&n===m.currentChapter?"active":""),o.innerHTML=`\n                        <small style="display:block; opacity:0.7">${e.title}</small> ${t.title}`,o.onclick=()=>{L(r,n),window.innerWidth<768&&h.classList.remove("open")},h.appendChild(o)})})}).catch(e=>{console.error("Error loading PDF:",e),m.onError({type:"load",message:`Failed to load PDF from ${s.pdf}`,error:e});const t=a.modules[r].title;alert(`Error loading PDF: ${t} > ${s.title}`)}).finally(()=>$(!1))}catch(e){console.error("Error setting up PDF loading:",e),m.onError({type:"load",message:"Failed to set up PDF loading",error:e}),$(!1)}})}function q(){m.currentPage<m.pdfDoc.numPages?(C=!0,m.currentPage++,m.zoom=100,T(m.currentPage).then(()=>{P(),M()}),x()):a.modules[m.currentModule].chapters[m.currentChapter+1]?L(m.currentModule,m.currentChapter+1):a.modules[m.currentModule+1]&&L(m.currentModule+1,0)}function F(){m.currentPage>1?(C=!0,m.currentPage--,m.zoom=100,T(m.currentPage).then(()=>{P(),M()}),x()):m.currentChapter>0&&L(m.currentModule,m.currentChapter-1)}const D=((e,r)=>{let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),e(...n)},r)}})(()=>{m.pdfDoc&&T(m.currentPage)},150),j=r.querySelector(".next-btn"),B=r.querySelector(".prev-btn"),H=r.querySelector(".pdf-viewer-toggle-btn"),I=r.querySelector(".fullscreen-btn"),A=r.querySelector(".pdf-viewer-canvas-container");A.addEventListener("click",()=>A.focus()),A.addEventListener("scroll",E,!0),m.isFullscreen=!1;const R="pdfViewer_sidebarCollapsed";function V(){m.isFullscreen=!m.isFullscreen;const e=r.querySelector(".pdf-viewer-main");m.isFullscreen?(e.classList.add("fullscreen"),I.setAttribute("aria-pressed","true")):(e.classList.remove("fullscreen"),I.setAttribute("aria-pressed","false"))}m.sidebarCollapsed="true"===l.getItem(R),m.sidebarCollapsed&&h.classList.add("collapsed"),j.onclick=q,B.onclick=F,I.onclick=V,H.onclick=()=>{if(window.innerWidth<768){const e=h.classList.toggle("open");H.setAttribute("aria-expanded",e)}else m.sidebarCollapsed=!m.sidebarCollapsed,h.classList.toggle("collapsed"),l.setItem(R,m.sidebarCollapsed),H.setAttribute("aria-pressed",m.sidebarCollapsed)};const W=r.querySelector(".zoom-out-btn"),Z=r.querySelector(".zoom-in-btn"),_=r.querySelector(".zoom-input");W&&(W.onclick=function(){S(m.zoom-10)}),Z&&(Z.onclick=function(){S(m.zoom+10)}),_&&(_.addEventListener("keypress",e=>{if("Enter"===e.key){let e=parseInt(_.value);isNaN(e)?_.value=m.zoom+"%":S(e)}}),_.addEventListener("blur",()=>{/^\d{3}%?$/.test(_.value.trim())||(_.value=m.zoom+"%")}));const N=e=>{r.contains(document.activeElement)&&("ArrowRight"===e.key&&q(),"ArrowLeft"===e.key&&F(),"Escape"===e.key&&m.isFullscreen&&V())};m.listeners.keyHandler=N,document.addEventListener("keydown",N);const O=e=>{if(A===document.activeElement||A.contains(e.target)){const r=A,t=r.scrollHeight-r.scrollTop<=r.clientHeight+1,n=0===r.scrollTop,o=e.deltaY>0,i=e.deltaY<0;return void((t&&o||n&&i)&&e.preventDefault())}};m.listeners.wheelHandler=O,A.addEventListener("wheel",O,{passive:!1});const G=new ResizeObserver(D);return G.observe(b.parentElement),m.resizeObserver=G,M(),L(0,0),m}}}(window);