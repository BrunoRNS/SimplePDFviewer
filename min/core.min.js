/**
 * Simple JavaScript PDF Viewer
 * 
 * @version rolling-release
 * @license MIT
 * @author BrunoRNS
 * @see https://github.com/BrunoRNS/SimplePDFviewer
 * @see https://github.com/mozilla/pdf.js
 * @see https://www.jsdelivr.com/?docs=gh
 */
!function(e){"use strict";const r="3.11.174",t=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${r}/pdf.min.js`,n=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${r}/pdf.worker.min.js`;let o=!1,i=!1;const a=[];e.PDFViewer={init:function(r,d,l={}){const s=(e=>e?e instanceof HTMLElement?{valid:!0,error:null}:{valid:!1,error:"Container must be an HTML element."}:{valid:!1,error:"Container element is required."})(r);if(!s.valid)return console.error(`PDFViewer: ${s.error}`),null;const c=(e=>{if(!e)return{valid:!1,error:"Course object is required."};if("string"!=typeof e.title)return{valid:!1,error:"Course must have a title (string)."};if(!Array.isArray(e.modules))return{valid:!1,error:"Course must have modules array."};if(0===e.modules.length)return{valid:!1,error:"Course must have at least one module."};for(let r=0;r<e.modules.length;r++){const t=e.modules[r];if("string"!=typeof t.title)return{valid:!1,error:`Module ${r} must have a title.`};if(!Array.isArray(t.chapters))return{valid:!1,error:`Module ${r} must have chapters array.`};if(0===t.chapters.length)return{valid:!1,error:`Module ${r} must have at least one chapter.`};for(let e=0;e<t.chapters.length;e++){const n=t.chapters[e];if("string"!=typeof n.title)return{valid:!1,error:`Module ${r}, Chapter ${e} must have a title.`};if("string"!=typeof n.pdf)return{valid:!1,error:`Module ${r}, Chapter ${e} must have a pdf URL.`}}}return{valid:!0,error:null}})(d);if(!c.valid)return console.error(`PDFViewer: ${c.error}`),null;(()=>{if(document.getElementById("pdf-viewer-styles"))return;const e=document.createElement("style");e.id="pdf-viewer-styles",e.textContent="\n            .pdf-viewer-container { display: flex; height: 100%; width: 100%; font-family: system-ui, -apple-system, sans-serif; background: #f0f2f5; overflow: hidden; position: relative; }\n            .pdf-viewer-sidebar { position: absolute; top: 0; left: -100%; width: 280px; height: 100%; background: #2c3e50; color: #fff; transition: all 0.3s ease; z-index: 1001; overflow-y: auto; box-shadow: 2px 0 10px rgba(0,0,0,0.2); }\n            .pdf-viewer-sidebar.open { left: 0; }\n            .pdf-viewer-main { flex: 1; display: flex; flex-direction: column; min-width: 0; }\n            .pdf-viewer-controls { display: flex; align-items: center; justify-content: center; gap: 15px; padding: 10px; background: #fff; border-bottom: 1px solid #ddd; z-index: 10; }\n            .pdf-viewer-canvas-container { flex: 1; overflow: auto; display: flex; justify-content: center; align-items: flex-start; padding: 20px; background: #525659; }\n            .pdf-viewer-canvas { max-width: 100%; height: auto; box-shadow: 0 0 15px rgba(0,0,0,0.3); background: #fff; }\n            .pdf-viewer-loading-overlay { position: absolute; top:0; left:0; right:0; bottom:0; background: rgba(255,255,255,0.7); display: flex; align-items: center; justify-content: center; z-index: 20; }\n            .pdf-viewer-chapter-item { padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #34495e; transition: background 0.2s; }\n            .pdf-viewer-chapter-item:hover { background: #3d566e; }\n            .pdf-viewer-chapter-item.active { background: #3498db; border-left: 4px solid #fff; }\n            .pdf-viewer-btn { padding: 10px 16px; min-height: 44px; min-width: 44px; border: none; border-radius: 4px; cursor: pointer; background: #3498db; color: white; font-weight: 500; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }\n            .pdf-viewer-btn:hover { background: #2980b9; }\n            .pdf-viewer-btn:active { background: #1f618d; }\n            .pdf-viewer-btn:disabled { background: #bdc3c7; cursor: not-allowed; }\n            @media (min-width: 768px) {\n                .pdf-viewer-sidebar { position: relative; left: 0; }\n                .pdf-viewer-toggle-btn { display: none; }\n            }\n        ",document.head.appendChild(e)})();const p={currentModule:0,currentChapter:0,currentPage:1,pdfDoc:null,renderTask:null,onError:l.onError||(()=>{}),listeners:{},nextPage:()=>y(),prevPage:()=>x(),loadChapter:(e,r)=>w(e,r),destroy:()=>function(){document.removeEventListener("keydown",D),p.resizeObserver&&p.resizeObserver.disconnect();p.renderTask&&p.renderTask.cancel()}()};r.innerHTML='\n            <div class="pdf-viewer-container">\n                <aside class="pdf-viewer-sidebar" role="navigation" aria-label="PDF chapters">\n                </aside>\n                <main class="pdf-viewer-main">\n                    <div class="pdf-viewer-controls" role="toolbar" aria-label="PDF viewer controls">\n                        <button class="pdf-viewer-btn pdf-viewer-toggle-btn" aria-label="Toggle sidebar" aria-expanded="false">&#9776;</button>\n                        <button class="pdf-viewer-btn prev-btn" aria-label="Previous page">Previous</button>\n                        <span class="page-info" aria-live="polite" aria-atomic="true">Page: <span class="cur">1</span> / <span class="tot">-</span></span>\n                        <button class="pdf-viewer-btn next-btn" aria-label="Next page">Next</button>\n                    </div>\n                    <div class="pdf-viewer-canvas-container">\n                        <canvas class="pdf-viewer-canvas" role="img" aria-label="PDF page content"></canvas>\n                    </div>\n                </main>\n                <div class="pdf-viewer-loading-overlay" style="display:none;" aria-live="polite">Loading...</div>\n            </div>\n        ';const u=r.querySelector(".pdf-viewer-sidebar"),f=r.querySelector(".pdf-viewer-canvas"),v=r.querySelector(".pdf-viewer-loading-overlay"),g=f.getContext("2d"),h=()=>{r.querySelector(".cur").textContent=p.currentPage,r.querySelector(".tot").textContent=p.pdfDoc?p.pdfDoc.numPages:"-"},m=e=>v.style.display=e?"flex":"none";function b(e){if(!(!p.pdfDoc||e<1||e>p.pdfDoc.numPages))return p.renderTask&&p.renderTask.cancel(),p.pdfDoc.getPage(e).then(e=>{try{const r=f.parentElement.clientWidth-40,t=window.devicePixelRatio||1,n=r/e.getViewport({scale:1}).width,o=e.getViewport({scale:n*t});return f.width=o.width,f.height=o.height,f.style.width=o.width/t+"px",f.style.height=o.height/t+"px",p.renderTask=e.render({canvasContext:g,viewport:o}),p.renderTask.promise}catch(e){console.error("Error rendering page:",e),p.onError({type:"render",message:"Failed to render page",error:e})}}).catch(e=>{"RenderingCancelledException"!==e.name&&(console.error("Error rendering page:",e),p.onError({type:"render",message:"Failed to render page",error:e}))})}function w(r,l){const s=d.modules[r]?.chapters[l];if(!s){const e=`Invalid module or chapter index: module=${r}, chapter=${l}`;return console.error(e),void p.onError({type:"load",message:e})}m(!0),p.currentModule=r,p.currentChapter=l,function(r){if(void 0!==e.pdfjsLib)return i=!0,r();if(a.push(r),o)return;o=!0;const d=document.createElement("script");d.src=t,d.onload=()=>{for(e.pdfjsLib.GlobalWorkerOptions.workerSrc=n,i=!0;a.length>0;)a.shift()()},document.head.appendChild(d)}(()=>{try{pdfjsLib.getDocument(s.pdf).promise.then(e=>{p.pdfDoc=e,p.currentPage=1,b(1),h(),u.innerHTML=`<div style="padding:20px; font-weight:bold; border-bottom:1px solid #444;">${d.title}</div>`,d.modules.forEach((e,r)=>{e.chapters.forEach((t,n)=>{const o=document.createElement("div");o.className="pdf-viewer-chapter-item "+(r===p.currentModule&&n===p.currentChapter?"active":""),o.innerHTML=`<small style="display:block; opacity:0.7">${e.title}</small> ${t.title}`,o.onclick=()=>{w(r,n),window.innerWidth<768&&u.classList.remove("open")},u.appendChild(o)})})}).catch(e=>{console.error("Error loading PDF:",e),p.onError({type:"load",message:`Failed to load PDF from ${s.pdf}`,error:e});const t=d.modules[r].title;alert(`Error loading PDF: ${t} > ${s.title}`)}).finally(()=>m(!1))}catch(e){console.error("Error setting up PDF loading:",e),p.onError({type:"load",message:"Failed to set up PDF loading",error:e}),m(!1)}})}function y(){p.currentPage<p.pdfDoc.numPages?(p.currentPage++,b(p.currentPage),h()):d.modules[p.currentModule].chapters[p.currentChapter+1]?w(p.currentModule,p.currentChapter+1):d.modules[p.currentModule+1]&&w(p.currentModule+1,0)}function x(){p.currentPage>1?(p.currentPage--,b(p.currentPage),h()):p.currentChapter>0&&w(p.currentModule,p.currentChapter-1)}const k=((e,r)=>{let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),e(...n)},r)}})(()=>{p.pdfDoc&&b(p.currentPage)},150),P=r.querySelector(".next-btn"),C=r.querySelector(".prev-btn"),E=r.querySelector(".pdf-viewer-toggle-btn");P.onclick=y,C.onclick=x,E.onclick=()=>{const e=u.classList.toggle("open");E.setAttribute("aria-expanded",e)};const D=e=>{r.contains(document.activeElement)&&("ArrowRight"===e.key&&y(),"ArrowLeft"===e.key&&x())};p.listeners.keyHandler=D,document.addEventListener("keydown",D);const $=new ResizeObserver(k);return $.observe(f.parentElement),p.resizeObserver=$,w(0,0),p}}}(window);